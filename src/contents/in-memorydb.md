---
path: "/in-memorydb"
date: "2019-09-28"
title: "ë©”ëª¨ë¦¬ DB(Redis, ë©¤ìºì‰¬ë“œ ë©”ëª¨ë¦¬)"
---

---

##ğŸš€ëª©í‘œ
1. In-memory DBë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ë¥¼ ì•Œê³  ì‹¤ì œ ì ìš©ë˜ëŠ” ì‚¬ë¡€ë¥¼ ì°¾ì•„ë³´ì  
2. memcachedì™€ redisë¥¼ ë¹„êµí•˜ê³  ìƒí™©ì— ë§ëŠ” ì„ íƒì„ í•  ìˆ˜ ìˆë‹¤.   
3. redisë¥¼ ì˜ ì‚¬ìš©í•˜ëŠ” ë²•ì„ ì•Œì


##ğŸ¤·â€  In-memory DBë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ   

#### ì‹¤ì‹œê°„ ì²˜ë¦¬ ìš”êµ¬ ì¦ëŒ€ -> í•˜ë“œì›¨ì–´ êµ¬ë§¤ ìœ ì§€ ê´€ë¦¬ -> ê¸°ì—… ì…ì¥ì—ì„œëŠ” ë¶€ë‹´    

* â€¢ hdd ê¸°ë°˜ ë°ì´í„° ì²˜ë¦¬ ë°©ì‹ì€ ë°ì´í„° ì–‘ì´ ê¸‰ì¦í•  ê²½ìš° ê³¼ë¶€í™”ë‚˜ ë³‘ëª©í˜„ìƒì´ ë°œìƒí•œë‹¤  
* â€¢ í•˜ë“œë””ìŠ¤í¬ê°€ ì•„ë‹Œ ì²˜ë¦¬ ì†ë„ê°€ ë¹ ë¥¸ ë©”ëª¨ë¦¬ì—ì„œ ì‹¤ì‹œê´€ ê´€ë¦¬í•˜ì—¬ ë°ì´í„° ì²˜ë¦¬ì‹œê°„ì„ ë‹¨ì¶•í•  ìˆ˜ ìˆë‹¤.  
* â€¢ ì „ì›ì´ êº¼ì§€ë©´ ë°ì´í„°ê°€ ì‚­ì œë˜ê¸° ë–„ë¬¸ì— ë‚ ë¼ ê°€ë„ ìƒê´€ì—†ëŠ” ì„ì‹œë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ”ë° ì£¼ë¡œ ì“°ì¸ë‹¤.

> ex) ë¡œê·¸ì¸ì„¸ì…˜

* _âœ” í•˜ì§€ë§Œ  ë©”ëª¨ë¦¬ íŠ¹ì„±ìƒ ì˜êµ¬ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ê´€ë¦¬í•˜ê¸° ì–´ë µê³  ìš©ëŸ‰ì´ ì œí•œì ì´ë‹¤._

#        

##ğŸ§ In-Memory Databaseë€?
- â€¢ ë°ì´í„°ê°€ ë©”ì¸ë©”ëª¨ë¦¬ì— ì„¤ì¹˜ë˜ì–´ ìš´ì˜ëœë‹¤. (ë©”ëª¨ë¦¬ì˜ ê°€ê²©ì´ ìš©ëŸ‰ëŒ€ë¹„ ë‚®ì•„ì¡Œë‹¤)
- â€¢ RDBMSë³´ë‹¤ ë‚´ë¶€ê°€ ë” ë‹¨ìˆœí•˜ë©° ì ì€ CPU ëª…ë ¹ì„ ì‹¤í–‰í•˜ì—¬ ë¹ ë¥´ë‹¤
- â€¢ key-value ë°©ì‹ìœ¼ë¡œ ì €ì¥
- â€¢ ì €ì¥ê³µê°„ì— ì œì•½ì´ ìˆë‹¤. (ë¬¼ë¡  RDBMSë„ ê·¸ë ‡ë‹¤.)
- â€¢ ë©”ëª¨ë¦¬ ì‚¬ìš©ìœ¼ë¡œ input / outputì´ ë¹ ë¥´ë‹¤.
- â€¢ ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸ë‹¤.
- â€¢ ë§ì€ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë¥¼ ì§€ì›í•œë‹¤.
###memcached  
2003ë…„ Brad fitzpartrickì— ì˜í•´ ê°œë°œ
ì´í›„ Perlì—ì„œ Cë¡œ ë‹¤ì‹œ ì‘ì„±ë˜ì—ˆë‹¤.  
__ì¥ì __  
ë©€í‹°ìŠ¤ë ˆë“œì´ë¯€ë¡œ ì‰½ê²Œ í™•ì¥í•  ìˆ˜ ìˆë‹¤.(ìˆ˜í‰ì  í™•ì¥)
-> Redis 3.0 ì—ì„œëŠ” ê°€ëŠ¥í•´ì¡Œë‹¤.
íŠ¸ë˜í”½ì´ ë§ì€ ì›¹ ì‚¬ì´íŠ¸ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë° ì¢‹ë‹¤.(ì‘ë‹µì†ë„ê°€ ì•ˆì •ì )
ë°ì´í„° íƒ€ì…ì´ Stringë¿ì´ë‹¤. ì½ê¸° ì „ìš©ì´ë¯€ë¡œ ë³µì¡í•˜ì§€ ì•Šë‹¤.  
__ë‹¨ì __  
restartì‹œ ë°ì´í„°ê°€ ì†ì‹¤ë˜ê³  ìºì‹œë¥¼ ë‹¤ì‹œ ì‘ì„±í•˜ëŠ”ë° ë§ì€ ë¹„ìš©ì´ ë“ ë‹¤.
LRU ì‚­ì œ ì •ì±…ë§Œ ì§€ì›í•œë‹¤.

__ë©”ëª¨ë¦¬ êµ¬ì¡°__
í´ë¼ì´ì–¸íŠ¸ê°€ ì „ì†¡í•œ ë°ì´í„°ë¥¼ ë°ì´í„° í¬ê¸°ì— ë”°ë¼ slab classë¥¼ ì„ íƒí•œ í›„ ê·¸ slab classê°€ í¬í•¨ëœ chunkëª©ë¡ì— ì €ì¥
->ë©”ëª¨ë¦¬ ì¡°ê°ì´ ë°œìƒí•˜ì§€ ì•Šì§€ë§Œ ê³µê°„ ë‚­ë¹„ë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ ìˆë‹¤.
###redis
2009ë…„ Salvatore Sanfilippoì— ì˜í•´ ê°œë°œ

__ì¥ì __  
ë‹¤ì–‘í•œ ë°ì´í„° êµ¬ì¡°ë¥¼ ì§€ì›í•œë‹¤.
ìºì‹œ ê´€ë¦¬ ë¶€ë¶„ì—ì„œëŠ” redisê°€ ë‚«ë‹¤.(ê°€ì¥ ìµœê·¼ì— ì‚¬ìš©í•œ ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš© ìƒˆë¡œìš´ ë°ì´í„°ì™€ í¬ê¸°ê°€ ë¹„ìŠ·í•œ ë°ì´í„°ë¥¼ ì„ì˜ë¡œ ì œê±°)
key-value ê°’ì„ 512MBë¥¼ í—ˆìš©í•œë‹¤. (memcachedëŠ” key 250byte valueëŠ” 1MB)
ë°ì´í„°ë¥¼ ë³µì œí•  ìˆ˜ ìˆë‹¤.

__ë‹¨ì __  
ì‹±ê¸€ìŠ¤ë ˆë“œì´ë‹¤.
ë©”ëª¨ë¦¬ íŒŒí¸í™” ì´ìŠˆê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤.

__ë©”ëª¨ë¦¬ êµ¬ì¡°__
ë©”ëª¨ë¦¬ í• ë‹¹ í›„ ë©”ëª¨ë¦¬ ë¸”ë¡ í—¤ë”ì— ë©”ëª¨ë¦¬ í¬ê¸°ë¥¼ ì €ì¥
-> ì´ ë¶€ë¶„ì€ ë‚˜ì¤‘ì—


`ë³µì¡í•œ êµ¬ì¡°ì™€ ì‘ì—…ì„ ì§€ì›í•  ë•ŒëŠ” redis ê°€ëŠ¥í•œ ë‹¨ìˆœí•œ ëª¨ë¸ì´ í•„ìš”í•œ ê²½ìš°ëŠ” memcached`


##Redis Persistence - ë°ì´í„° ì €ì¥

__RDB (Snapshotting)__
- ì§€ì •ëœ ê°„ê²©ìœ¼ë¡œ ë°ì´í„° ì„¸íŠ¸ì˜ íŠ¹ì • ì‹œì  ìŠ¤ëƒ…ìƒ·ì„ ìˆ˜í–‰í•´ ë°ì´í„° ì „ì²´ë¥¼ ë°”ì´ë„ˆë¦¬ íŒŒì¼ë¡œ ì €ì¥í•œë‹¤.
- saveì™€ bgsave ë°©ì‹ì´ ìˆë‹¤.  

>  _save_  
 > blocking ë°©ì‹ìœ¼ë¡œ ìˆœê°„ì ìœ¼ë¡œ redisì˜ ëª¨ë“  ë™ì‘ì„ ì •ì§€ì‹œí‚¤ê³  ê·¸ ë–„ snapshotì„ diskì— ì €ì¥í•œë‹¤  
 _bgsave_  
 > non-blocking ë°©ì‹ìœ¼ë¡œ ë³„ë„ì˜ processë¥¼ ë„ìš´ í›„ ëª…ë ¹ì–´ ìˆ˜í–‰ ë‹¹ì‹œì˜ ë©”ëª¨ë¦¬ snapshotì„ diskì— ì €ì¥  

__ì¥ì __
- ë‹¨ì¼ ì‹œì  íŒŒì¼ì´ë¯€ë¡œ ë°±ì—…ì— ì í•©í•˜ë‹¤.
- ì¬ë‚œ ë³µêµ¬ì— ë§¤ìš° ìœ ìš©í•˜ë‹¤.
- ë¹ ë¥¸ ì¬ì‹œì‘  
__ë‹¨ì __
- redisê°€ ì‘ë™ì„ ë©ˆì¶œ ê²½ìš° snapshotì¶”ì¶œ ì´í›„ ë°ì´í„°ëŠ” ìœ ì‹¤ëœë‹¤.  


__AOP(Append On File)__
- ê¸°ë³¸ì ìœ¼ë¡œ non-blocking call ë°©ì‹
- ì„œë²„ê°€ ìˆ˜ì‹ í•œ write/update ì—°ì‚° ëª¨ë‘ë¥¼ logíŒŒì¼ì— ê¸°ë¡
- ì¬ì‹œì‘í•  ë•Œ write/update ì—°ì‚°ì„ ìˆœì°¨ì ìœ¼ë¡œ ì¬ì‹¤í–‰ í•˜ì—¬ ë°ì´í„°ë¥¼ ë³µêµ¬

__ì¥ì __
- ì„œë²„ê°€ ë‹¤ìš´ë”œ ê²½ìš° ë°ì´í„° ìœ ì‹¤ì´ ë°œìƒí•˜ì§€ ì•ŠìŒ
- text file ì´ë¯€ë¡œ ìˆ˜ì •ì´ ê°€ëŠ¥í•´ ì‹¤ìˆ˜ë¡œ ì˜ëª»ëœ ëª…ë ¹ì–´ë¥¼ ë‚ ë ¸ì„ ê²½ìš° shutdowní•˜ê³  ìˆ˜ì •í•œ í›„ restart í•˜ë©´ ì •ìƒì ìœ¼ë¡œ DBë¥¼ ì‚´ë¦´ ìˆ˜ ìˆë‹¤.  
__ë‹¨ì __
- RDB íŒŒì¼ë³´ë‹¤ ìš©ëŸ‰ì´ í¬ë‹¤.
- ë³µêµ¬ ì‹œ wirte/update ì—°ì‚°ì„ ë‹¤ì‹œ ì¬ì‹¤í–‰í•˜ì—¬ restartê°€ ëŠë¦¬ë‹¤.


##redisë¥¼ ì˜ ì‚¬ìš©í•´ì•¼í•˜ëŠ” ì´ìœ 
1. ì‹±ê¸€ì“°ë ˆë“œì—¬ì„œ ëª¨ë“  í‚¤ë¥¼ ë³´ì—¬ì£¼ëŠ” keys ëª…ë ¹ì–´ë‚˜ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ëŠ” flushall ì‚¬ìš© ì‹œ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ë¥¼ ìš”ì²­í•˜ëŠ” ëª…ë ¹ì€ ëª» ë°›ì•„ë“¤ì¸ë‹¤.
2. 32bit í™˜ê²½ì—ì„œëŠ” ìµœëŒ€ 3GB ë©”ëª¨ë¦¬ë§Œ ì‚¬ìš© ê°€ëŠ¥í•˜ì§€ë§Œ 64bit ì‹œìŠ¤í…œì—ì„œëŠ” ì œì•½ì´ ì—†ì–´ osì˜ ê°€ìƒë©”ëª¨ë¦¬ê¹Œì§€ ì“°ë‹¤ê°€ í•œê³„ë¥¼ ì¸ì‹í•˜ì§€ ëª»í•´ ë¬¸ì œë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ ìˆë‹¤
 -> mexmemory ì„¤ì • : maxmemoryì´ìƒ ì‚¬ìš©í•˜ë©´ ë©”ëª¨ë¦¬ ì •ì±…ì— ë”°ë¼ ê³¼ê±° í‚¤ë“¤ì´ ì‚­ì œ
3. Collection ì‚¬ìš© ì‹œ ì²˜ë¦¬ì‹œê°„ì´ ì„œë¹„ìŠ¤ì— ì§€ì¥ì„ ì¤„ ë§Œí¼ ì˜¤ë˜ ê±¸ë¦¬ê¸° ë•Œë¬¸ì— êµ³ì´ ì‚¬ìš©í•˜ë ¤ë©´ 1ë§Œê±´ ë¯¸ë§Œìœ¼ë¡œë§Œ ì²˜ë¦¬
4. redisì„œë²„ ì¥ì•  ìš”ì¸ 99.9%ê°€ RDBê°€ ì°¨ì§€í•œë‹¤. ì‹±ê¸€ì“°ë ˆê°€ ì•„ë‹ˆë¼ fork() ë°©ì‹ì„ ì‚¬ìš©í•´ë„ ë©”ëª¨ë¦¬ë¥¼ 2ë°°ë¡œ ì¡ì•„ë¨¹ê¸°ì— RDBì„¤ì •ê°’ì„ ì˜ ì¡°ì •í•´ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.




[^ë³‘ëª©í˜„ìƒ] : ì•„ì–´ì•„ì–´ì•„ã…“

_ì¶œì²˜_   
https://aws.amazon.com/ko/elasticache/redis-vs-memcached/  
https://www.infoworld.com/article/3063161/why-redis-beats-memcached-for-caching.html  
https://medium.com/@Alibaba_Cloud/redis-vs-memcached-in-memory-data-storage-systems-3395279b0941  
https://www.notion.so/gahyeon/DB-Redis-b7f4cd11674c4bd5ad07b9bbd467ec55#05e604e74c5c44c28484c34b8f5c208f  
https://www.notion.so/gahyeon/DB-Redis-b7f4cd11674c4bd5ad07b9bbd467ec55#df05fce763984152aaea60d84a8c8e1f    
https://www.notion.so/gahyeon/DB-Redis-b7f4cd11674c4bd5ad07b9bbd467ec55#5fc679228ec343259bb119029c1f4159  
https://www.notion.so/gahyeon/DB-Redis-b7f4cd11674c4bd5ad07b9bbd467ec55#5b24cfd4fb7941a49dba7371610f6200  
https://www.notion.so/gahyeon/DB-Redis-b7f4cd11674c4bd5ad07b9bbd467ec55#7fe073d620ba48fab28206fcf966d479  
https://www.notion.so/gahyeon/DB-Redis-b7f4cd11674c4bd5ad07b9bbd467ec55#5ab5f348a4d5485b9b91d0ae94971b4a  
https://www.notion.so/gahyeon/DB-Redis-b7f4cd11674c4bd5ad07b9bbd467ec55#bcfc82bc15b14169bc397c3ca751741c   
https://www.notion.so/gahyeon/DB-Redis-b7f4cd11674c4bd5ad07b9bbd467ec55#a118248e5b344cf1a6ff468891e00f4c
